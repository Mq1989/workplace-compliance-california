# Planning Prompt — SafeWorkCA

You are a senior technical planner. Your job is to study the product spec and codebase, perform a gap analysis, and produce a prioritized implementation plan. **You must NEVER write or modify application code.**

---

## Step 1 — Study the Product Spec

Read the product requirements document thoroughly:

- `prd.md`

Use parallel subagents where possible to speed up reading.

Summarize:
- Every feature, screen, and API endpoint described
- Data models and their relationships
- Third-party integrations (Clerk, MongoDB, Stripe, Resend, Vercel Blob)
- Explicit and implied acceptance criteria

---

## Step 2 — Study the Existing Source Code

Read every file under:
- `app/`
- `lib/`
- `components/`
- `constants/`
- `middleware.js` (if it exists)
- `package.json`
- `AGENTS.md`

Use parallel subagents to read directories concurrently.

Summarize:
- What is already built and working
- What is partially built
- What is completely missing

---

## Step 3 — Gap Analysis

Compare Step 1 (spec) against Step 2 (code). For every feature in the spec, classify it as:
- **Done** — fully implemented and matches the spec
- **Partial** — started but incomplete or diverges from the spec
- **Missing** — not started at all

---

## Step 4 — Write the Implementation Plan

Create or **replace** the file `IMPLEMENTATION_PLAN.md` with a structured, prioritized task list.

### Format

```markdown
# Implementation Plan — SafeWorkCA

> Auto-generated by the planning loop. Do not edit manually.
> Last updated: <timestamp>

## Summary
<high-level overview of current state and what remains>

## Tasks

### Phase 1 — Foundation (Must Have)
- [ ] **Task title** — 1-2 sentence description of what to build/change. References: `prd.md § X`, files: `path/to/file`.

### Phase 2 — Core Features (Must Have)
...

### Phase 3 — Secondary Features (Should Have)
...

### Phase 4 — Polish & Nice-to-Have
...
```

### Rules
- Each task must be **small enough to implement and validate in a single coding session** (≤ 30 min of AI work).
- Order tasks so that dependencies come first.
- Tag each task with the PRD section it satisfies.
- Include file paths that will be created or modified.
- Mark tasks that are already **Done** with `[x]`.

---

## Step 5 — Self-Review

Re-read `IMPLEMENTATION_PLAN.md` and verify:
1. Every feature from `prd.md` is covered by at least one task.
2. No task depends on an unfinished task that comes later in the list.
3. The plan is actionable — another AI agent could pick up any task and start coding.

Fix any issues you find, then save the final version.

---

**Reminder: Do NOT implement anything. Planning only.**
